---
title: ""
author: "Francisco Orejarena"
date: "April 3, 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


##This is a journey...
##Through time and space...
#STAR WARS
##Just kidding. But wouldn't it have been awesome if I could do the scrolling intro?
```{r, libraries, dataimport, echo=FALSE}

library(tidyverse)

dumdum <- read_csv("data_raw/pa_5_data/lang_data_raw.csv")
head(dumdum)

```
As I export the data, I need to discuss any hypothesis that I have about it, so that I may write the results up, and say whether or not my interpretation is correct. What I think will be accurately read from this data is the direct correlation of age with language aptitude.

#Tidy Rightey

This section, dedicated to the play on words of 'tidy whiteys', is about correctly tidying data.

##First Tidying

First, we need to be able to sort what is essential data from non-essential. Usually, this is very subjective, and not entirely right depending on the dataset. However, my first step is going to be to eliminate the column 'Motivation' as it seems redundant or at the very least, not as informative as proficiency, and would thus be pointless. It also seems that it holds no useful information for a casual interpreter of the data.

While motivation is going to be used for iq evaluations, it isn't terribly detrimental to remove it to show how to tidy redundant data (and is easy t0 reimplement into the data).

What I do for this is take the function 'select' and simply select every column, except motivation.

```{r tidy1}

gumgum <- dumdum %>%
  select(., -motivation)

head(gumgum)
```

With the removal of Motivation, we can now discuss what to do with the other pieces of data. 

##Tidying Two: Electric Boogaloo

Now we want to be able to consolidate the columns a little bit further than we already have.

I use the 'gather' function for this, usually creating two columns, which enables me to plot by an 'x' and a 'y'.

```{r tidy2}

gum <- gumgum %>%
  gather(., key, val)

head(gum)
```

Now that I have an acceptable table, I can reincorporate and reuse motivation.

##Episode III: Revenge of the List

Now I want to add another column in. This one is going to be called "composite_score", using iq and motivation as factors to evaluate.

This is a 2 steps back, 3 steps forward, so that I can explain what my process was. First, I struggled with how to incorporate the new column, and how to do it with the tidy data. Instead of trying to do something I knew was almost certainly out of my realm of knowledge, and losing time in the process, I decided that it would be in my best interest to start from the beginning of the data set, and add composite scores and retidy the data, creating a long and complicated sequel, yet interesting finale to my trilogy of data tidying.


```{r tidy3}

dumtidy <- dumdum %>%
  mutate(., composite_score = log(iq / 80) + log(motivation)) %>%
  separate(., col = id, into = c('number', 'gender', 'age'), sep = "_") %>%
  select(., -number, -gender, -motivation)

head(dumtidy)
```

Let me explain what as happened since the conception to the birth of this code: as I looked for answers in previously worked examples, in creatively trying to gather, spread, gather, spread ad naseum, I realized I had to use my one escape. In having you help me profe(and remembering that separate is what I needed), I realize that spread was not the function I wanted, and it was in fact separate, and that I was using separate wrongly as well. So, I started by mutating the data the original data to incorporate the new column, and then I had to separate the 'id' column into three additional columns: number, gender, age. Then I selected only age, iq, prof, and lastly composite score, as my variables, naming it 'dumtidy' because it is "dumb tidy", or "mad tidy".

This was definitely as eventful and stressful as when Anakin betrayed Obi-Wan (I'm blanking on movie trilogies, so I'm sticking with Star Wars, sorry).

#Lord of the Data: The Two Variables
##Fun Fact: I have never seen any of the Lord of the Rings (this includes the Hobbit Trilogy)

So, now it's time to try and plot this bad boy. My stress, anxiety, and really psychotic ramblings on this midterm have all built up to this moment where I can try and plot with colors, shapes, and other interesting plotting mechanics that makes me feel important.

```{r plots}

ggplot(dumtidy, aes(x = prof, y = composite_score, color = age)) +
  geom_point() +
  geom_smooth(method = lm) +
  scale_color_brewer(palette = "Set1")
  
```

I chose to do a scatterplot for a few reasons. The primary one being that I am not good at being creative with boxplots. They feel really restrictive; I am bad at trying to come up with ways to utilize the data well, and I always come up short, forgetting to include something along the way. So, I used a scatterplot, which I can use colors and shapes, and an x and a y axis. It's great! Scatterplots are great. And the results are clear: older individuals tend to have higher composite scores. This makes sense, as the younger participants are not as developed linguistically. 

#Model Fitting

Using interaction between age and composite score, I fit a model to such an interaction, with the reference point being "ageolder".
```{r int}

mod_int <- lm(prof ~ age * composite_score, data = dumtidy)
summary(mod_int)

```

The interesting thing about the model and its summary is that interaction between age and composite score seems to not be significant, as evidenced by the p-values of the interaction itself.

#Results and Intepretation

The general linear model was used to interpret this data set, for the effect of motivation of iq of younger participants and older participants. Speakers were split by younger and older, where proficiency was a continuous variable. The experience of readers were dummy coded with older participants(ageolder) as the reference group. Main effects were age and composite score (log(iq / 80) + log(motivation)), while interaction of younger participants and composite scores were tested using nested model.

There was a main effect of age (F(1) = 0.0896, p < 0.001), composite score (F(1) = .9112; p < 0.001), but not of age and composite score interaction (F(1) = -0.04628; p < 0.01). Overall, proficiency shows a positive correlation with age. However, iq may have played a larger role than discussed. Specifically, lower iq was more prevelant in younger participants, who showed a slower increase than their counterparts, the older group.
