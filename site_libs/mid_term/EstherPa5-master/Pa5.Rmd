---
title: "index.Rmd"
author: "Esther Hur"
date: "April 3, 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
###1. Load data and show first six rows.
```{r}
library(tidyverse)

my_lang_data_raw <- read_csv("./data_raw/pa_5_data/lang_data_raw.csv")
head(my_lang_data_raw)
```
###2. Tidy data and add new column
I have separated the id column into one column as 'gender' and one column as 'age'. The id column was renamed as group. Next I added a new column, calling it 'composite_score'.
```{r}

my_tidy_data <- my_lang_data_raw%>%
  separate(., col = id, into = c('group', 'gender', 'age'), sep = "_")
  

my_tidy_data$composite_score <- log(my_tidy_data$iq / 80) + log(my_tidy_data$motivation)
head(my_tidy_data)
```

###3. Descriptive Statistic
```{r}
my_tidy_data %>%
  group_by(.,age) %>%
  summarize(.,mean_score = mean(prof), sd_score = sd(prof),
            mean_exp =mean(composite_score), sd_exp = sd(composite_score))
```

```{r}

my_mod <-lm(prof ~age, data = my_tidy_data)
  summary(my_mod)$coef
```
            
            You need to create this metric for all of the models you will fit (see instructions below). In sum, you want to know if proficiency scores vary as a function of age (younger/older) and composite aptitude score.
            
###4. Create an Informative plot
```{r}
my_tidy_data %>% 
  select(., age, prof, composite_score) %>%
  ggplot(., aes(x = age, y = prof, color = composite_score)) +
  geom_point() +
  geom_smooth(method= 'lm')
```

###5. Again, you are interested in determining if proficiency scores vary as a function of age and composite_score. Fit the appropriate model. Test the two-way interaction, the main effect of age, and the main effect of composite_score.

```{r}
mod_nul <- lm(prof ~1, data = my_tidy_data)
summary(mod_nul)
```
```{r}
mod_cat <-lm(prof ~ age, data = my_tidy_data)
summary(mod_cat)
```

```{r}
mod_con <-lm(prof ~ age + composite_score, data = my_tidy_data)
summary(mod_con)
```
```{r}
mod_int <-lm(prof ~ age * composite_score, data = my_tidy_data)
summary(mod_int)
```
```{r}
anova(mod_nul, mod_cat, mod_con, mod_int)

```


###6. Descriptive Statistics

## Model description
The learner data was analyzed using a general linear model. The prof was the criterion with age of learning (young vs old) and composite score as predictors. The composite score factor was dummy coded by with average experience set as a reference group (?). Main effects and age of learning by composite score interaction were assessed using nested model comparisons. Experiment-wise alpha was set at 0.05


## Interpretation
There was a main effect of age of learning (F(1) = 67.0531, p<0.001), composite interaction (F(1) = 84.6757, p<0.001), as well as age by composite score interaction (F(1) = 9.8147, p<0.01). The model containing the interaction provided the best fit data (R2 = 0.4518). Overall, proficiency increased as a function of age of learning. However, the size of effect was modulated by composite interaction.Specifically, average composite interaction showed an increase of 0.35436 points +/-  0.07447 (t = 4.758, p <0.001) per year. 


